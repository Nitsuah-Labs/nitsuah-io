#!/bin/sh
# Add Node.js to PATH for Git Bash on Windows
export PATH="/c/Program Files/nodejs:$PATH"

echo "üîç Running pre-commit validation (same as CI)..."

# Run ALL the checks that CI runs
echo "0/5 Quick smoke accessibility test (pre-commit)..."
npm run test:precommit || exit 1

echo "1/4 Checking types..."
npm run typecheck || exit 1

echo "2/4 Checking formatting..."
echo "2a/4 Auto-format staged files (lint-staged)..."
npx lint-staged || {
	echo "npx lint-staged failed or unavailable; falling back to project formatter..."
	npm run format || exit 1
	git add -A
}

echo "2b/4 Checking formatting..."
npm run format:check || exit 1

echo "3/4 Running Jest tests..."
npm test || exit 1

echo "‚úÖ All pre-commit checks passed!"


